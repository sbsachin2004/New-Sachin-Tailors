<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Sachin Tailors</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .animate-slide-in {
      animation: slideIn 0.5s ease-out;
    }
    @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
  </style>
</head>
<body class="bg-gray-100 font-sans">
  <header class="bg-blue-900 text-white p-4 flex justify-between items-center">
    <h1 class="text-3xl font-bold">Sachin Tailors</h1>
    <a href="{{ url_for('logout') }}" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105">Logout</a>
  </header>
  <main class="max-w-6xl mx-auto py-8 px-4">
    <h1 class="text-2xl font-bold text-blue-900 mb-4 animate-slide-in">Admin Dashboard</h1>
    <a href="{{ url_for('analytics') }}" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105 mb-4 inline-block">View Analytics</a>
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <ul class="list-none p-4 mb-4 rounded-lg">
          {% for category, message in messages %}
            <li class="{{ 'bg-green-100 text-green-800 p-2 rounded' if category == 'message' else 'bg-red-100 text-red-800 p-2 rounded' }}">{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    <h2 class="text-xl font-bold text-blue-900 mb-4 animate-slide-in">Add Customer</h2>
    <form method="POST" action="{{ url_for('add_customer') }}" class="mb-8 animate-slide-in">
      <input type="text" name="mobile" placeholder="Mobile Number" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2">
      <input type="text" name="customer_code" placeholder="Customer Code" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2">
      <textarea name="measurements" placeholder="Measurements (e.g., Chest: 40, Waist: 32)" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2"></textarea>
      <button type="submit" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105">Add Customer</button>
    </form>

    <h2 class="text-xl font-bold text-blue-900 mb-4 animate-slide-in">Customers</h2>
    <table class="w-full border-collapse mb-8 animate-slide-in">
      <tr class="bg-blue-900 text-white">
        <th class="p-2">Mobile</th>
        <th class="p-2">Customer Code</th>
        <th class="p-2">Measurements</th>
        <th class="p-2">Actions</th>
      </tr>
      {% for customer in customers %}
        <tr class="border-b hover:bg-gray-200">
          <td class="p-2">{{ customer.mobile }}</td>
          <td class="p-2">{{ customer.customer_code }}</td>
          <td class="p-2">{{ customer.measurements }}</td>
          <td class="p-2 space-x-2">
            <a href="{{ url_for('edit_customer', mobile=customer.mobile) }}" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105">Edit</a>
            <form method="POST" action="{{ url_for('delete_customer', mobile=customer.mobile) }}" style="display:inline;">
              <button type="submit" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105" onclick="return confirm('Are you sure you want to delete this customer and their orders?')">Delete</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </table>

    <h2 class="text-xl font-bold text-blue-900 mb-4 animate-slide-in">Search Orders</h2>
    <form action="{{ url_for('admin_dashboard') }}" method="POST" class="mb-4 flex space-x-2 animate-slide-in">
      <input type="text" name="bill_no" placeholder="Enter Bill Number (e.g., ABC12345)" class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900">
      <button type="submit" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105">Search Order</button>
      <a href="{{ url_for('admin_dashboard') }}" class="bg-gray-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-gray-600 transition duration-300 transform hover:scale-105">Clear Search</a>
    </form>

    <h2 class="text-xl font-bold text-blue-900 mb-4 animate-slide-in">Create Order</h2>
    <form method="POST" action="{{ url_for('create_order') }}" class="mb-8 animate-slide-in">
      <input type="text" name="mobile" placeholder="Customer Mobile" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2">
      <textarea name="description" placeholder="Description" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2"></textarea>
      <input type="number" name="total_amount" placeholder="Total Amount" step="0.01" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2">
      <input type="number" name="advance" placeholder="Advance" step="0.01" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2">
      <input type="date" name="delivery_date" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2">
      <select name="status" required class="border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-900 mb-2">
        <option value="Pending">Pending</option>
        <option value="In Progress">In Progress</option>
        <option value="Completed">Completed</option>
      </select>
      <button type="submit" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105">Create Order</button>
    </form>

    <h2 class="text-xl font-bold text-blue-900 mb-4 animate-slide-in">Orders</h2>
    <table class="w-full border-collapse animate-slide-in">
      <tr class="bg-blue-900 text-white">
        <th class="p-2">Bill No</th>
        <th class="p-2">Mobile</th>
        <th class="p-2">Measurements</th>
        <th class="p-2">Description</th>
        <th class="p-2">Total Amount</th>
        <th class="p-2">Advance</th>
        <th class="p-2">Due Amount</th>
        <th class="p-2">Delivery Date</th>
        <th class="p-2">Created Date</th>
        <th class="p-2">Status</th>
        <th class="p-2">Actions</th>
      </tr>
      {% for order in orders %}
        <tr class="border-b hover:bg-gray-200">
          <td class="p-2">{{ order.bill_no }}</td>
          <td class="p-2">{{ order.mobile }}</td>
          <td class="p-2">{{ order.measurements }}</td>
          <td class="p-2">{{ order.description }}</td>
          <td class="p-2">{{ order.total_amount }}</td>
          <td class="p-2">{{ order.advance }}</td>
          <td class="p-2">{{ order.due_amount }}</td>
          <td class="p-2">{{ order.delivery_date }}</td>
          <td class="p-2">{{ order.created_date }}</td>
          <td class="p-2">{{ order.status }}</td>
          <td class="p-2 space-x-2">
            <a href="{{ url_for('edit_order', bill_no=order.bill_no) }}" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105">Edit</a>
            <form method="POST" action="{{ url_for('delete_order', bill_no=order.bill_no) }}" style="display:inline;">
              <button type="submit" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105" onclick="return confirm('Are you sure you want to delete this order?')">Delete</button>
            </form>
            <a href="{{ url_for('download_invoice', bill_no=order.bill_no) }}" class="bg-yellow-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-yellow-600 transition duration-300 transform hover:scale-105">Download Invoice</a>
          </td>
        </tr>
      {% endfor %}
    </table>
  </main>
  <footer class="bg-blue-900 text-white p-4 text-center">
    &copy; 2025 Sachin Tailors. All rights reserved.
  </footer>
</body>
</html>